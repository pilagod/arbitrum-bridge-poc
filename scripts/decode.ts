import { ethers } from "ethers";
import ArbSysABI from "@abi/arbSys";
import { arbProvider } from "@network";

// withdraw 0.1 ETH at 2021/06/23 11:30:29 AM
// arb block number: 104299
// eth block number: 8812171
// batch number: 47
// batch index: 6
const withdrawETHEvent = {
  event: "L2ToL1Transaction",
  data: "0x000000000000000000000000a29939d7e3b97098018e054b440b875657cd98300000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000001976b000000000000000000000000000000000000000000000000000000000086768b0000000000000000000000000000000000000000000000000000000060d2aad5000000000000000000000000000000000000000000000000016345785d8a000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000",
  topics: [
    "0x5baaa87db386365b5c161be377bc3d8e317e8d98d71a3ca7ed7d555340c8f767",
    "0x000000000000000000000000a29939d7e3b97098018e054b440b875657cd9830",
    "0x00000000000000000000000000000000000000000000000000000000000005d9",
    "0x000000000000000000000000000000000000000000000000000000000000002f",
  ],
};

// withdraw 1 TKN at 2021/6/23/ 5:28:54 PM
// arb block number: 107775
// eth block number: 8813604
// batch number: 48
// batch index: 1
const withdrawTKNEvent = {
  event: "L2ToL1Transaction",
  data: "0x000000000000000000000000195c107f3f75c4c93eba7d9a1312f19305d6375f0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001a4ff0000000000000000000000000000000000000000000000000000000000867c240000000000000000000000000000000000000000000000000000000060d2fed6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000001242e567b36000000000000000000000000a516070a4f7a772fff8fa264c4b368ed7066d51c000000000000000000000000a29939d7e3b97098018e054b440b875657cd9830000000000000000000000000a29939d7e3b97098018e054b440b875657cd98300000000000000000000000000000000000000000000000000de0b6b3a764000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000b20000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
  topics: [
    "0x5baaa87db386365b5c161be377bc3d8e317e8d98d71a3ca7ed7d555340c8f767",
    "0x00000000000000000000000091169dbb45e6804743f94609de50d511c437572e",
    "0x00000000000000000000000000000000000000000000000000000000000005dd",
    "0x0000000000000000000000000000000000000000000000000000000000000030",
  ],
};

async function main() {
  const { event, data, topics } = withdrawETHEvent;
  const arbsys = new ethers.Contract("ArbSys", ArbSysABI, arbProvider);
  const result = arbsys.interface.decodeEventLog(event, data, topics);
  console.log("result: ", result);
  console.log("batchNumber: ", result.batchNumber.toString());
  console.log("indexInBatch: ", result.indexInBatch.toString());
}

main().then(() => {
  process.exit(0);
});
